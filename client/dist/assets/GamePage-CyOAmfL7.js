import{R as P,j as t,r,a as G,u as _,I as y,_ as g,b as A}from"./index-C0qmoWQM.js";import{a as I}from"./axios-DTyqpfTh.js";import{H as z,L as S}from"./LogoutBtn-BKBxKGxO.js";const N=P.memo(e=>(console.log("pop modal re-rendered"),t.jsxs("div",{id:"hider",className:"fixed inset-0 z-40 flex justify-center items-center",onClick:a=>{a.stopPropagation(),e.action==="cardInfoShow"?e.setCardClicked(!1):e.action==="delete"?e.setCrossClicked(!1):e.action==="update"?e.setUpdateClicked(!1):e.action==="Add"&&e.setaddGameClicked(!1)},children:[e.children,"       "]}))),U=e=>{console.log("addform re-rendered");const a="pl-2 outline-none bg-green-700 w-[100%] text-white border-2 border-white h-8";return t.jsxs("form",{className:`flex flex-col gap-8 text-black items-center bg-black\r
         w-60 p-4 z-50 cursor-auto`,onClick:s=>s.stopPropagation(),children:[t.jsx("h1",{className:"text-white font-bold text-lg",children:"ADD GAME"}),t.jsx("input",{type:"text",placeholder:"Title",className:a,value:e.gameInfo.title,onChange:s=>{const n={...e.gameInfo,title:s.target.value,genre:e.gameInfo.genre,description:e.gameInfo.description};e.setGameInfo(n)}}),t.jsx("input",{type:"text",placeholder:"Genre",className:a,value:e.gameInfo.genre,onChange:s=>{const n={...e.gameInfo,title:e.gameInfo.title,genre:s.target.value,description:e.gameInfo.description};e.setGameInfo(n)}}),t.jsx("textarea",{className:`h-max resize-none bg-green-700 text-white w-[100%]
        p-2 border-2 border-white`,placeholder:"Description",value:e.gameInfo.description,onChange:s=>{const n={...e.gameInfo,title:e.gameInfo.title,genre:e.gameInfo.genre,description:s.target.value};e.setGameInfo(n)}}),t.jsxs("div",{className:"flex gap-4 ",children:[t.jsx("button",{className:"bg-green-600 p-2 text-white hover:bg-green-700",onClick:s=>{s.preventDefault(),e.setaddGameClicked(!1),e.gameAdder(s)},children:"Done"}),t.jsx("button",{className:"bg-red-600 p-2 text-white hover:bg-red-500",onClick:s=>{s.preventDefault(),e.setaddGameClicked(!1)},children:"Cancel"})]})]})},E=e=>{console.log("addgame re-rendered");const[a,s]=r.useState(!1),[n,d]=r.useState({title:"",genre:"",description:""}),{token:c}=r.useContext(G),u=_();async function m(p){var f,h,b,v;try{console.log("token in: ",c),p.preventDefault();let i=await I.post("http://localhost:8000/game",n,{headers:{token:c}});g.success(i.data.message,{position:"top-right",style:{height:"60px",border:"1px solid green"}}),d({title:"",genre:"",description:""}),e.triggerRefresh()}catch(i){i.response.status==498&&u("/login"),(h=(f=i==null?void 0:i.response)==null?void 0:f.data)!=null&&h.issue?(console.log(i.response.data.issue),g.error(i.response.data.issue[0].message+" at "+i.response.data.issue[0].path)):(v=(b=i==null?void 0:i.response)==null?void 0:b.data)!=null&&v.message?g.error(i.response.data.message):g.error(i.message)}}return t.jsxs("div",{className:"flex flex-col gap-8 items-center",children:[t.jsx("button",{className:`bg-transparent border-2 border-white \r
          w-28 py-2 text-white hover:bg-green-500`,onClick:()=>{s(!a)},children:a?"Hide":"Add game"}),a?t.jsx(N,{setaddGameClicked:s,action:"Add",children:t.jsx(U,{title:e.title,description:e.description,genre:e.genre,setGameInfo:d,gameInfo:n,setaddGameClicked:s,gameAdder:m,action:"Add"})}):null,t.jsx(y,{})]})},R=e=>t.jsxs("div",{className:`flex flex-col gap-4 items-center justify-center bg-black p-4\r
        {console.log("gameInfoBox re-rendered")}\r
    w-80 cursor-auto`,onClick:a=>{a.stopPropagation()},children:[t.jsx("h1",{className:"z-10 font-bold text-3xl font-mono",children:e.title}),t.jsxs("p",{className:"z-10",children:[t.jsx("span",{className:"font-bold z-10 text-white text-sm",children:"Genre: "}),e.genre]}),t.jsxs("p",{className:"z-10",children:[t.jsx("span",{className:"font-bold text-white text-sm",children:"Description: "}),e.description]}),t.jsx("button",{className:"bg-red-600 p-2 text-white hover:bg-red-700",onClick:a=>{a.stopPropagation(),e.setCardClicked(!1)},children:"Hide"})]}),H=e=>t.jsx("div",{children:t.jsx("button",{className:`border-2 border-green-500 bg-green-500 scale-90 \r
        transition-transform duration-500 delay-0 linear hover:scale-125`,onClick:a=>{a.stopPropagation(),e.setCrossClicked(!0),e.setCardClicked(!1)},children:"❌"})}),F=e=>t.jsx("p",{className:"bg-green-600 text-white p-2 hover:bg-green-700",onClick:e.clicked,children:e.updateClicked?"Cancel":"Update"}),M="/assets/freeFire-CpHIZmrS.jpg",B=e=>(console.log("confirmation box re-endered"),t.jsxs("div",{className:`bg-black w-96 h-52 flex justify-center items-center flex-col\r
            gap-12 z-50 cursor-auto`,onClick:a=>{a.stopPropagation()},children:[t.jsxs("p",{children:["Do you want to Delete",t.jsxs("span",{className:"text-red-500 font-bold",children:[" ",e.title]})]}),t.jsxs("div",{className:"flex gap-12 text-white",children:[t.jsx("button",{className:"bg-green-500 px-4 hover:bg-green-700",onClick:a=>{a.preventDefault(),a.stopPropagation(),e.delClicked(a),e.setCrossClicked(!1)},children:"Yes"}),t.jsx("button",{className:"bg-red-500 px-4 hover:bg-red-700",onClick:a=>{a.stopPropagation(),a.preventDefault(),e.setCrossClicked(!1)},children:"No"})]})]})),L=e=>{console.log("update form re-rendered ");const a="pl-2 outline-none bg-green-700 w-[100%] text-white border-2 border-white h-8";return t.jsxs("form",{className:`flex flex-col gap-8 text-black items-center bg-black\r
        w-60 p-4 z-50 cursor-auto`,onClick:s=>s.stopPropagation(),children:[t.jsx("h1",{className:"text-white font-bold text-lg",children:"UPDATE GAME"}),t.jsx("input",{type:"text",className:a,value:e.newGameInfo.updated_title,onChange:s=>{e.setNewGameInfo({updated_title:s.target.value,updated_genre:e.newGameInfo.updated_genre,updated_description:e.newGameInfo.updated_description})}}),t.jsx("input",{type:"text",className:a,value:e.newGameInfo.updated_genre,onChange:s=>{e.setNewGameInfo({updated_title:e.newGameInfo.updated_title,updated_genre:s.target.value,updated_description:e.newGameInfo.updated_description})}}),t.jsx("textarea",{className:`h-max resize-none bg-green-700 text-white w-[100%]
        p-2 border-2 border-white`,value:e.newGameInfo.updated_description,onChange:s=>{e.setNewGameInfo({updated_title:e.newGameInfo.updated_title,updated_genre:e.newGameInfo.updated_genre,updated_description:s.target.value})}}),t.jsxs("div",{className:"flex gap-4 ",children:[t.jsx("button",{className:"bg-green-600 p-2 text-white hover:bg-green-700",onClick:s=>{s.preventDefault(),e.UpdateGame(s),e.setUpdateClicked(!1)},children:"Done"}),t.jsx("button",{className:"bg-red-600 p-2 text-white hover:bg-red-500",onClick:s=>{s.preventDefault(),e.setUpdateClicked(!1),e.setNewGameInfo({updated_description:e.description,updated_title:e.title,updated_genre:e.genre})},children:"Cancel"})]})]})},D=r.createContext(null),T=e=>{console.log("game re-rendered");const a=_();let[s,n]=r.useState(!1),[d,c]=r.useState(!1);const[u,m]=r.useState({updated_title:e.title,updated_description:e.description,updated_genre:e.genre}),[p,f]=r.useState(!1),{token:h}=r.useContext(G),b=r.useContext(D);async function v(x){var j,C,w,k,o;console.log("token in delete game : ",h),x.preventDefault();try{let l=await I.delete("http://localhost:8000/game/"+e.title,{headers:{token:h}});g.success(l.data.message,{position:"top-right",style:{height:"60px",border:"1px solid green"}}),b()}catch(l){((j=l==null?void 0:l.response)==null?void 0:j.status)==498&&a("/login"),console.log(l),(w=(C=l==null?void 0:l.response)==null?void 0:C.data)!=null&&w.issue?(console.log(l.response.data.issue),g.error(l.response.data.issue[0].message+" at "+l.response.data.issue[0].path)):(o=(k=l==null?void 0:l.response)==null?void 0:k.data)!=null&&o.message?g.error(l.response.data.message):g.error(l.message)}}async function i(x){var j,C,w,k;try{console.log("token in delete game: ",h),x.preventDefault();let o={updated_title:u.updated_title||e.title,updated_description:u.updated_description||e.description,updated_genre:u.updated_genre||e.genre},l=await I.put("http://localhost:8000/game?title_to_update="+e.title,o,{headers:{token:h}});g.success(l.data.message,{position:"top-right",style:{height:"60px",border:"1px solid green"}}),b()}catch(o){o.response.status&&a("/login"),console.log(o),(C=(j=o==null?void 0:o.response)==null?void 0:j.data)!=null&&C.issue?(console.log(o.response.data.issue),g.error(o.response.data.issue[0].message+" at "+o.response.data.issue[0].path)):(k=(w=o==null?void 0:o.response)==null?void 0:w.data)!=null&&k.message?g.error(o.response.data.message):g.error(o.message)}}return t.jsxs("div",{className:`min-h-72 w-48 px-4 pb-4 pt-2 bg-white text-green-500 text-center \r
        cursor-pointer group flex flex-col items-center overflow-hidden`,onClick:x=>{f(!0),x.stopPropagation()},children:[t.jsxs("div",{className:"flex justify-between w-full items-center",children:[t.jsx(F,{clicked:x=>{x.preventDefault(),c(!0),x.stopPropagation(),f(!1)},updateClicked:d}),t.jsx(H,{setCrossClicked:n,setCardClicked:f})]}),t.jsx("img",{className:`z-0 object-cover object-center h-[90%] mt-4 cursor-pointer\r
            group-hover:scale-105 transition-all duration-500 ease-in-out`,src:M,alt:"unable to load"}),t.jsx("h1",{className:"font-bold text-xl bg-green-700 text-white p-1 mt-2",children:e.title}),p&&t.jsx(N,{setCardClicked:f,action:"cardInfoShow",children:t.jsx(R,{title:e.title,genre:e.genre,description:e.description,setCardClicked:f})}),d?t.jsx(N,{setUpdateClicked:c,action:"update",children:t.jsx(L,{title:e.title,description:e.description,genre:e.genre,UpdateGame:i,setUpdateClicked:c,setNewGameInfo:m,newGameInfo:u,action:"update"})}):null,s?t.jsx(N,{setCrossClicked:n,action:"delete",children:t.jsx(B,{title:e.title,delClicked:v,setCrossClicked:n})}):null,t.jsx(y,{})]})},Y=e=>{console.log("games re-rendered");let a=[...e.games];for(let n=0;n<a.length;n++)for(let d=n+1;d<a.length;d++)if(new Date(a[d].createdAt)>new Date(a[n].createdAt)){let c=a[n];a[n]=a[d],a[d]=c}console.log("original games array:",e.games),console.log("sorted games: ",a);let s=a.map((n,d)=>t.jsx(T,{title:n.title,description:n.description,genre:n.genre},n.title));return t.jsx(t.Fragment,{children:t.jsx("div",{className:"grid grid-cols-5 gap-12 items-start",children:s})})},K=()=>{console.log("game page re-rendered");const[e,a]=r.useState([]),[s,n]=r.useState(!1),d=_(),{token:c}=r.useContext(G);r.useEffect(()=>{console.log("token in game page: ",c),c?I.get("http://localhost:8000/games",{headers:{token:c}}).then(m=>{var p;console.log("games fetched:",m.data.games),a((p=m==null?void 0:m.data)==null?void 0:p.games)}).catch(m=>{console.log(m)}):d("/login")},[s]);function u(){n(!s)}return t.jsxs("div",{className:`min-h-[100%] bg-[#40670C]\r
        flex flex-col items-center gap-8 pb-12`,children:[t.jsxs("div",{className:"flex justify-between px-[2px] items-center w-full",children:[t.jsx(A,{}),t.jsx(z,{}),t.jsx(S,{})]}),t.jsxs(D.Provider,{value:u,children:[t.jsx(E,{triggerRefresh:u}),t.jsx(Y,{games:e})]})]})};export{K as default};
